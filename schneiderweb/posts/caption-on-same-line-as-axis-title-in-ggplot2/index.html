<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Caption on same line as axis title in ggplot2 â€“ W. Joel Schneider</title><meta name=author content="W. Joel Schneider"><meta name=description content="W. Joel Schneider's Academic Website"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6 crossorigin=anonymous><link rel=stylesheet href=/css/all.min.css><link rel=stylesheet href=/css/academicons.min.css><link rel=stylesheet type=text/css href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.css><link rel=stylesheet href=https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/fonts.css><link rel=icon type=image/png href=/favicon.png><link href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css rel=stylesheet type=text/css></head><body data-spy=scroll data-target=#toc><div class=container><header><link rel=alternate type=application/rss+xml href=/index.xml><nav class="navbar navbar-expand-sm bg-dark navbar-dark d-flex mt-2 py-0"><div class=d-inline-flex><ul class=navbar-nav><li class=nav-item><a href=/ title=Home class=nav-link><i class='fa fa-home'></i></span></a></li><li class=nav-item><a href=/posts/ title=Posts class=nav-link>Posts</a></li><li class=nav-item><a href=/presentations title=Presentations class=nav-link>Presentations</a></li><li class=nav-item><a href=/projects/ title=Projects class=nav-link>Projects</a></li><li class=nav-item><a href=/courses/ title=Courses class=nav-link>Courses</a></li><li class=nav-item><a href=/vita title=Vita class=nav-link>Vita</a></li><li class=nav-item><a href=/contact title="Contact Me" class=nav-link><i class="fas fa-id-card"></i></span></a></li></ul></div></nav></header><div id=content><article class=post><header class=p-2><div class=row><div class=col-md-9><h2>Caption on same line as axis title in ggplot2</h2></div><div class="col-md-3 text-md-end"><span class=small>2021-07-21</span></div></div><p>By W. Joel Schneider</p></header><div class="bg-light p-2"><h2>Summary</h3>You can put the caption on the line as the x-axis title</div><section class=body><script src=/posts/caption-on-same-line-as-axis-title-in-ggplot2/index_files/header-attrs/header-attrs.js></script><p>Sometimes I want to put a plot caption in the lower right corner of the plot.</p><pre class=r><code>library(tidyverse)
p &lt;- ggplot() +
  stat_function(xlim = c(-4,4), fun = dnorm, n = 801) + 
  labs(x = &quot;z-scores&quot;, caption = &quot;Note: Mean = 0, SD = 1&quot;)

p</code></pre><p><img src=/posts/caption-on-same-line-as-axis-title-in-ggplot2/index_files/figure-html/default%20position-1.svg width=75%></p><p>However, I want the caption to be a little higher, on the same line as the x-axis title. To do so, set a a negative top margin:</p><pre class=r><code>p + theme(plot.caption = element_text(margin = margin(t = -10, unit = &quot;pt&quot;)))</code></pre><p><img src=/posts/caption-on-same-line-as-axis-title-in-ggplot2/index_files/figure-html/on%20same%20line-1.svg width=75%></p><p>Here is a more finished example.</p><pre class=r><code>library(ggnormalviolin)
library(ggtext)
my_font_size = 16
my_font &lt;- &quot;Roboto Condensed&quot;
update_geom_defaults(geom = &quot;text&quot;,new = list(family = my_font) )
update_geom_defaults(geom = &quot;label&quot;,new = list(family = my_font) )
update_geom_defaults(&quot;richtext&quot;, list(family = my_font))
theme_set(theme_minimal(base_size = my_font_size, base_family = my_font))

d_rect &lt;- tibble(SS = 100, 
                 width = c(20, 40, 60, 80, 122), 
                 fill = paste0(&quot;gray&quot;, c(95, 90, 80, 70, 65) - 25)) %&gt;% 
  arrange(-width)

tibble(
  Scale = c(
    &quot;Fluid Reasoning&quot;,
    &quot;Verbal Comprehension&quot;,
    &quot;Visual-Spatial Processing&quot;,
    &quot;Working Memory&quot;,
    &quot;Processing Speed&quot;,
    &quot;Population&quot;),
  y = c(5:1 - 0.5, 0),
  SS = c(115, 111, 109, 86, 79, 100),
  rxx = c(.93, .92, .92, .92, .88, 0),
  width = c(rep(1.4, 5), 10.4),
  alpha = c(rep(1, 5), .3)
) %&gt;% 
  mutate(true_hat = rxx * (SS - 100) + 100, 
         see = ifelse(rxx == 0, 15, 15 * sqrt(rxx - rxx ^ 2)),
         Scale = fct_inorder(Scale) %&gt;% fct_rev()) %&gt;% 
  ggplot(aes(y, SS)) + 
  geom_tile(data = d_rect, aes(width = 5.8, x = 2.9, 
                               fill = fill, 
                               height = width, 
                               y = SS)) + 
  geom_normalviolin(aes(mu = true_hat, 
                                        sigma = see, 
                                        width = width,
                                        alpha = alpha), 
                                    face_left = F, 
                    fill = &quot;white&quot;) + 
  geom_richtext(aes(label = ifelse(
    Scale == &quot;Population&quot;, 
    &quot;Population Mean&quot;, 
    paste0(&quot;&lt;span style=&#39;font-size:8.5pt;color:white&#39;&gt;(&quot;, 
           round(100 * pnorm(SS, 100, 15),0),
           &quot;) &lt;/span&gt;&quot;,
           SS, 
           &quot;&lt;span style=&#39;font-size:9pt;color:#666666&#39;&gt; (&quot;, 
           round(100 * pnorm(SS, 100, 15),0),
           &quot;)&lt;/span&gt;&quot;))), 
    vjust = -0.2, 
    lineheight = .8, 
    fill = NA, 
    color = &quot;gray20&quot;,
    label.color = NA,
    label.padding = unit(0,&quot;mm&quot;)) +
  geom_text(aes(y = true_hat, 
                label = ifelse(Scale == &quot;Population&quot;, 
                               &quot;&quot;, 
                               as.character(Scale))), 
            vjust = 1.5, 
            color = &quot;gray15&quot;,
            lineheight = .8) +
  geom_linerange(aes(ymin = true_hat - 1.96 * see,
                      ymax = true_hat + 1.96 * see), 
                 size = .5) +
  geom_pointrange(aes(ymin = true_hat - see,
                      ymax = true_hat + see), 
                  size = 1.2, 
                  fatten = 1.5) +
  geom_text(aes(x = x, y = y, label = label), 
            data = tibble(
              y = c(49.5, 65, 75, 85, 100, 115, 125, 135, 150.5), 
              x = 5.5, 
              label = c(&quot;Extremely\nLow Range&quot;, 
                                  &quot;Very\nLow&quot;, 
                                  &quot;Low\nRange&quot;, 
                                  &quot;Low\nAverage&quot;, 
                                  &quot;Average\nRange&quot;, 
                                  &quot;High\nAverage&quot;, 
                                  &quot;High\nRange&quot;, 
                                  &quot;Very\nHigh&quot;, 
                                  &quot;Extremely\nHigh Range&quot;)), 
            color = &quot;white&quot;, lineheight = .8, size = 4.25) +
  scale_y_continuous(
    &quot;Standard Scores &lt;span style=&#39;font-size:11.7pt;color:#656565&#39;&gt;&lt;br&gt;
    (and Percentile Ranks)&lt;/span&gt;&quot;, 
    breaks = seq(40, 160, 10), 
    limits = c(37, 163),
    labels = \(x) paste0(x,
                         &quot;&lt;br&gt;&lt;span style=&#39;font-size:10pt;color:#656565&#39;&gt;(&quot;, 
                         pnorm(x,100, 15) %&gt;% 
                           WJSmisc::proportion2percentile(digits = 2) %&gt;%
                           str_trim(), 
                         &quot;)&lt;/span&gt;&quot;),
    expand = expansion()) +
  scale_x_continuous(NULL, expand = expansion(), breaks = NULL) +
  scale_alpha_identity() +
  scale_fill_identity() +
  coord_flip(clip = &quot;off&quot;) + 
  theme(axis.title.x = element_markdown(hjust = 0, 
                                        margin = margin(t = 1.25, 
                                                        l = 2,
                                                        unit = &quot;mm&quot;)),
        axis.text.x = element_markdown(colour = &quot;gray20&quot;),
        plot.caption = element_markdown(hjust = 0, 
                                        size = 10, 
                                        margin = margin(t = -10.25, 
                                                        l = 100, 
                                                        unit = &quot;mm&quot;), 
                                        color = &quot;gray40&quot;),
        plot.title = element_text(hjust = .025)) +
  labs(
    title = &quot;Display of Cognitive Test Scores&quot;,
    caption = &quot;**Notes:** The white normal curves represent the expected 
       true&lt;br&gt;score distributions for each observed score. The black lines&lt;br&gt;
       underneath span the 68% and 95% confidence intervals.&quot;)</code></pre><p><img src=/posts/caption-on-same-line-as-axis-title-in-ggplot2/index_files/figure-html/display%20scores-1.svg width=75%></p></section></article></div><footer><nav class="nav navbar-expand-md bg-dark navbar-dark my-1"><ul class=navbar-nav><li class=nav-item><a href="mailto:W.%20Joel%20Schneider%20%3cschneider@temple.edu%3e?subject=Question%20from%20your%20website&body=Dear%20Dr.%20Schneider%2C%0D%0A" class=nav-link target=_blank><i class="far fa-envelope" title=Email></i><span class="d-inline d-md-none">Email</span></a></li><li class=nav-item><a href=/media/schneider-vita.pdf class=nav-link target=_blank><i class="ai ai-cv" title="Curriculum Vitae"></i><span class="d-inline d-md-none">Curriculum Vitae</span></a></li><li class=nav-item><a href=https://www.researchgate.net/profile/W-Schneider-3 class=nav-link target=_blank><i class="ai ai-researchgate" title=ResearchGate></i><span class="d-inline d-md-none">ResearchGate</span></a></li><li class=nav-item><a href="https://scholar.google.com/citations?hl=en&pli=1&user=aojOxP4AAAAJ" class=nav-link target=_blank><i class="ai ai-google-scholar" title="Google Scholar"></i><span class="d-inline d-md-none">Google Scholar</span></a></li><li class=nav-item><a href=https://orcid.org/0000-0002-8393-5316 class=nav-link target=_blank><i class="ai ai-orcid" title=Orchid></i><span class="d-inline d-md-none">Orchid</span></a></li><li class=nav-item><a href=https://osf.io/whabf/ class=nav-link target=_blank><i class="ai ai-osf" title="Open Science Framework"></i><span class="d-inline d-md-none">Open Science Framework</span></a></li><li class=nav-item><a href=https://www.zotero.org/wjschne class=nav-link target=_blank><i class="ai ai-zotero" title=Zotero></i><span class="d-inline d-md-none">Zotero</span></a></li><li class=nav-item><a href=https://github.com/wjschne class=nav-link target=_blank><i class="fab fa-github" title=GitHub></i><span class="d-inline d-md-none">GitHub</span></a></li><li class=nav-item><a href=https://stackoverflow.com/users/4513316/joel-schneider class=nav-link target=_blank><i class="ai ai-stackoverflow" title=stackoverflow></i><span class="d-inline d-md-none">stackoverflow</span></a></li><li class=nav-item><a href=https://twitter.com/WJoelSchneider class=nav-link target=_blank><i class="fab fa-twitter" title=Twitter></i><span class="d-inline d-md-none">Twitter</span></a></li><li class=nav-item><a href=https://www.youtube.com/channel/UCFTUraTjxq743KfH-5gWrWg class=nav-link target=_blank><i class="fab fa-youtube" title=YouTube></i><span class="d-inline d-md-none">YouTube</span></a></li></ul></nav><p class=text-end><i class="fas fa-copyright"></i>2023</p></footer></div><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js></script>
<script>hljs.configure({languages:[]}),hljs.initHighlightingOnLoad()</script><script src=/js/math-code.js></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src=https://code.jquery.com/jquery-3.4.1.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js></script>
<script src=https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js></script></body></html>